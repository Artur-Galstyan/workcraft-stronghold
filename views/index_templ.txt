<script>\n        async function loadWorkers() {\n            try {\n                const response = await fetch('/api/peons');\n                const data = await response.json();\n\n                $('#workers').empty();\n\n                data.items.forEach(function(item) {\n                    if (item.status !== \"OFFLINE\") {\n                        const taskCell = item.current_task\n                            ? `<td class=\"px-4 py-2 link\">\n                                 <a href=\"/task/${item.current_task.id}\">\n                                   ${item.current_task}\n                                 </a>\n                               </td>`\n                            : `<td class=\"px-4 py-2 text-gray-500\">\n                                 No active task\n                               </td>`;\n\n                        $('#workers').append(`\n                            <tr>\n                            <td class=\"px-4 py-2\">\n                              <a class=\"link\" href=\"/peon/${item.id}\">\n                                ${item.id}\n                              </a>\n                            </td>\n                            <td class=\"px-4 py-2\">${item.status}</td>\n                            <td class=\"px-4 py-2\">${item.last_heartbeat}</td>\n                            <td class=\"px-4 py-2\">${item.queues}</td>\n                            ${taskCell}\n                            </tr>\n                        `);\n                    }\n                });\n            } catch (error) {\n                console.error('Error fetching workers:', error);\n            }\n        }\n\n        async function loadLast10Tasks() {\n          const count = 10;\n          try {\n            let filter = {\n              \"page\": 1,\n              \"per_page\": count,\n            }\n            const response = await fetch(`/api/tasks?query=${JSON.stringify(filter)}`);\n            if (!response.ok) {\n              console.error('Failed to fetch last 10 tasks');\n              console.error(await response.text());\n              return;\n            }\n            const data = await response.json();\n            $('#tasks').empty();\n\n            data.items.forEach(function(item) {\n              $('#tasks').append(`\n                <tr>\n                  <td class=\"px-4 py-2 truncate\">\n                    <a class=\"link\" href=\"/task/${item.id}\">\n                      ${item.id}\n                    </a>\n                  </td>\n                  <td class=\"px-4 py-2\">${item.task_name}</td>\n                  <td class=\"px-4 py-2\">\n                    <span class=\"px-2 py-1 rounded-full text-sm inline-block ${window.getStatusColor(item.status)}\">\n                      ${item.status}\n                    </span>\n                  </td>\n                  <td class=\"px-4 py-2\">${item.queue}</td>\n                  <td class=\"px-4 py-2 truncate\">\n                    <a class=\"link\" href=${item.peon_id ? `/peon/${item.peon_id}` : ''}>\n                      ${item.peon_id || 'No peon assigned'}\n                    </a>\n                  </td>\n                  <td class=\"px-4 py-2\">${item.created_at.replace('T', ' ').replace('Z', '')}</td>\n                </tr>\n              `);\n            });\n\n          } catch (error) {\n            console.error('Error fetching last 10 tasks:', error);\n          }\n        }\n\n        // Call the function when the document is ready\n        $(document).ready(function() {\n            loadWorkers();\n            loadLast10Tasks();\n\n            // Refresh every 5 seconds\n\n            setInterval(() => {\n              loadWorkers()\n              loadLast10Tasks()\n            }, 5000)\n        });\n        </script> <div class=\"p-4\"><h2 class=\"text-xl font-bold mt-4\">Active peons</h2><div class=\"overflow-x-auto\"><table class=\"table\"><thead><tr><th class=\"px-4 py-2\">ID</th><th class=\"px-4 py-2\">Status</th><th class=\"px-4 py-2\">Last Heartbeat</th><th class=\"px-4 py-2\">Queues</th><th class=\"px-4 py-2\">Current Task</th></tr></thead> <tbody id=\"workers\"></tbody></table></div><div class=\"my-4 flex justify-start\"><button class=\"btn\"><a href=\"/peons\">Show all peons</a></button></div><div class=\"divider my-20\"></div><h2 class=\"text-xl font-bold mt-4\">Last 10 Tasks</h2><div class=\"overflow-x-auto\"><table class=\"table\"><thead><tr><th class=\"px-4 py-2\">ID</th><th class=\"px-4 py-2\">Name</th><th class=\"px-4 py-2\">Status</th><th class=\"px-4 py-2\">Queue</th><th class=\"px-4 py-2\">Peon</th><th class=\"px-4 py-2\">Created At</th></tr></thead> <tbody id=\"tasks\"></tbody></table></div><div class=\"my-4 flex justify-start\"><button class=\"btn\"><a href=\"tasks\">Show all tasks</a></button></div></div>
